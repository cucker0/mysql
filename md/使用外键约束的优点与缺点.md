使用外键约束的优点与缺点
==

## 使用外键
**优点：**
1. 保证数据的完整性和一致性；
1. 可以迅速的建立一个可靠性非常高的数据库结构，而不用让应用程序层去做过多的检查，减少了程序的代码量；
1. 级联操作方便
1. 可以提高系统健壮性；
1. 可以实现开发人员和数据库设计人员的分工；


 
**缺点：**
1. 数据库需要维护外键的内部管理；
1. 外键等于把数据的一致性事务实现，全部交给数据库服务器完成；
1. 有了外键，当做一些涉及外键字段的增，删，更新操作之后，需要触发相关操作去检查，而不得不消耗资源；
1. 外键还会因为需要请求对其他表内部加锁而容易出现死锁情况；
1. 容易出现数据库I/O的瓶颈；
1. 在水平拆分和分库的情况下，外键是无法生效的
1. 每次做DELETE 或者UPDATE都必须考虑外键约束，会导致开发的时候很痛苦,测试数据极为不方便
 
 
 
## 不使用外键
**优点：**
1. 减少了数据库表与表之间各种关联的复杂性；
1. 牺牲应用服务器资源，换取数据库服务器的性能；
1. 将主动权把控在自己手里；
1. 去掉外键相当于优化数据库性能；
 
**缺点：**
1. 所有外键的约束，需要自己在逻辑层自己实现；
1. 会出现数据错误覆写，错误数据进库的情况；
1. 消耗了服务器的性能；
1. 业务层里夹带持久层特性，耦合；
 
 
## 总结
1. 互联网行业：不推荐使用外键。
    * 用户量大，并发度高，为此数据库服务器很容易成为性能瓶颈，尤其受IO能力限制，且不能轻易地水平扩展；
    * 若是把数据一致性的控制放到事务中，即让应用服务器承担此部分的压力；
    * 应用服务器一般都是可以做到轻松地水平的伸缩；
 
2. 传统行业：可以使用。
    * 软件应用的人数有限，换句话说是可控的；
    * 数据库服务器的数据量也一般不会超大，且活跃数据有限；